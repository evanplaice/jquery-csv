name: NPM Release

on:
  workflow_call:

jobs:
  npm:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@master
    - name: Publish
      run: |
        echo "//registry.npmjs.org/:_authToken=${{ secrets.NPM_AUTH_TOKEN }}" > ~/.npmrc
        npm publish --access public

    # runs-on: ubuntu-latest
    # permissions:
    #   contents: read
    #   id-token: write
    # steps:
    # - name: Checkout
    #   uses: actions/checkout@v4
    # - name: Setup
    #   uses: actions/setup-node@v4
    #   with:
    #     registry-url: "https://registry.npmjs.org"
    #     cache: npm
    # - run: npm ci
    # - run: cat /home/runner/work/_temp/.npmrc
    # - name: Publish
    #   run: |
    #     # Change publish registry
    #     echo "$(jq '.publishConfig.registry = "https://registry.npmjs.org"' package.json)" > package.json
    #     # Publish package
    #     npm publish --provenance --access public
    #   env:
    #     NODE_AUTH_TOKEN: ${{ secrets.NPM_AUTH_TOKEN }}
